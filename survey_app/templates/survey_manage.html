{% extends "base.html" %}
{% block content %}
<h2>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø—Ä–æ—Å–∞: {{ survey.title }}</h2>
<p class="text-muted">{{ survey.description }}</p>

<hr>

<!-- –§–æ—Ä–º–∞ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ –≤–æ–ø—Ä–æ—Å–∞ -->
<h4>‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –≤–æ–ø—Ä–æ—Å</h4>
<form method="post" class="mb-4">
    <div class="mb-3">
        <label class="form-label">–¢–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞</label>
        <input type="text" name="question_text" class="form-control" required>
    </div>

    <div class="mb-3">
        <label class="form-label">–¢–∏–ø –≤–æ–ø—Ä–æ—Å–∞</label>
        <select name="q_type" class="form-select">
            <option value="single">–û–¥–∏–Ω –≤–∞—Ä–∏–∞–Ω—Ç –æ—Ç–≤–µ—Ç–∞</option>
            <option value="multiple">–ù–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –æ—Ç–≤–µ—Ç–∞</option>
        </select>
    </div>

    <div class="mb-3">
        <label class="form-label">–í–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–∞ (–º–∏–Ω–∏–º—É–º –æ–¥–∏–Ω)</label>
        <input type="text" name="choice_text" class="form-control mb-2" placeholder="–í–∞—Ä–∏–∞–Ω—Ç 1">
        <input type="text" name="choice_text" class="form-control mb-2" placeholder="–í–∞—Ä–∏–∞–Ω—Ç 2">
    </div>

    <button type="submit" class="btn btn-success">–î–æ–±–∞–≤–∏—Ç—å –≤–æ–ø—Ä–æ—Å</button>
</form>

<hr>

<!-- –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã -->
<h4>üìã –í–æ–ø—Ä–æ—Å—ã</h4>
{% if survey.questions %}
    {% for q in survey.questions %}
        <div class="card mb-3">
            <div class="card-body">
                <h5>{{ loop.index }}. {{ q.text }}</h5>
                <span class="badge bg-secondary">
                    {% if q.q_type == "single" %} –û–¥–∏–Ω –æ—Ç–≤–µ—Ç {% else %} –ù–µ—Å–∫–æ–ª—å–∫–æ –æ—Ç–≤–µ—Ç–æ–≤ {% endif %}
                </span>

                <ul class="list-group mt-3">
                    {% for c in q.choices %}
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            {{ c.text }}
                            <a href="{{ url_for('main.delete_choice', choice_id=c.id, survey_id=survey.id) }}"
                               class="btn btn-sm btn-outline-danger">‚ûñ –£–¥–∞–ª–∏—Ç—å</a>
                        </li>
                    {% endfor %}
                </ul>

                <div class="mt-2">
                    <a href="{{ url_for('main.add_choice', question_id=q.id, survey_id=survey.id) }}"
                       class="btn btn-sm btn-outline-success">‚ûï –î–æ–±–∞–≤–∏—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç</a>
                    <a href="{{ url_for('main.delete_question', question_id=q.id, survey_id=survey.id) }}"
                       class="btn btn-sm btn-outline-danger"
                       onclick="return confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –≤–æ–ø—Ä–æ—Å?')">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –≤–æ–ø—Ä–æ—Å</a>
                </div>
            </div>
        </div>
    {% endfor %}
{% else %}
    <p class="text-muted">–í–æ–ø—Ä–æ—Å–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</p>
{% endif %}

<hr>

<!-- –ó–∞–≤–µ—Ä—à–∏—Ç—å –æ–ø—Ä–æ—Å -->
<form method="post" action="{{ url_for('main.finish_survey', survey_id=survey.id) }}">
    <button type="submit" class="btn btn-primary">‚úÖ –ó–∞–≤–µ—Ä—à–∏—Ç—å –∏ –æ–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –æ–ø—Ä–æ—Å</button>
    <a href="{{ url_for('main.index') }}" class="btn btn-secondary">‚¨Ö –í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é</a>
</form>

{% endblock %}
